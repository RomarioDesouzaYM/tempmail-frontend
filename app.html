<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Temporary Inbox ‚Äì TempMailFree</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- STEP 3: Allow indexing -->
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tempmailfree.site/app.html">

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      background: #0f172a;
      color: #e5e7eb;
      margin: 0;
    }

    nav {
      padding: 16px 20px;
    }

    nav a {
      color: #64748b;
      text-decoration: none;
      font-size: 0.9rem;
    }

    nav a:hover {
      text-decoration: underline;
    }

    /* ===== Loader ===== */
    .loader {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 14px;
      text-align: center;
    }

    .spinner {
      width: 36px;
      height: 36px;
      border: 3px solid #334155;
      border-top-color: #60a5fa;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .muted {
      color: #94a3b8;
      font-size: 0.95rem;
      max-width: 420px;
    }

    .hidden {
      display: none;
    }

    /* ===== App UI ===== */
    .box {
      background: #020617;
      padding: 24px;
      border-radius: 12px;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 10px 30px rgba(0,0,0,.4);
      margin: 40px auto;
    }

    h1 {
      margin-top: 0;
      font-size: 1.4rem;
    }

    input {
      width: 100%;
      box-sizing: border-box;
      padding: 12px;
      border-radius: 8px;
      border: none;
      margin-top: 10px;
      font-size: 1rem;
    }

    .email {
      margin-top: 16px;
      font-weight: bold;
      word-break: break-all;
    }

    .status {
      margin-top: 12px;
      font-size: 0.9rem;
      color: #94a3b8;
    }

    .mail {
      margin-top: 16px;
      padding: 12px;
      background: #020617;
      border-radius: 8px;
      border: 1px solid #1e293b;
      font-size: 0.9rem;
    }

    .notice {
      margin-top: 14px;
      font-size: 0.8rem;
      color: #64748b;
    }
  </style>
</head>

<body>

  <!-- ===== Simple Navigation (Fix: no dead-end) ===== -->
  <nav>
    <a href="/">‚Üê Back to Home</a>
  </nav>

  <!-- ===== Loading Mask ===== -->
  <div id="loading" class="loader">
    <div class="spinner"></div>
    <div class="muted">
      Initializing temporary inbox‚Ä¶<br />
      Waking up mail servers. This may take a few seconds.
    </div>
  </div>

  <!-- ===== App ===== -->
  <div id="app" class="hidden">
    <div class="box">
      <h1>Temporary Email</h1>
      <p>Choose your inbox name</p>

      <input id="name" placeholder="mylogin123" />

      <div class="email" id="email"></div>
      <div class="status" id="status">Ready for messages...</div>
      <div class="mail" id="mail"></div>

      <div class="notice">
        Servers may sleep during low traffic. Inbox will auto-refresh.
      </div>
    </div>

    <!-- ===== Product Explanation ===== -->
    <section style="max-width:720px;margin:60px auto;padding:0 20px;line-height:1.7;color:#cbd5f5;">

      <h2 style="color:#e5e7eb;">How this temporary inbox works</h2>
      <p>
        TempMailFree provides a disposable email inbox that allows you to receive emails without using your personal
        email address. You choose an inbox name, and incoming emails sent to that address appear automatically on this page.
      </p>
      <p>
        The inbox runs directly in your browser and periodically checks for new messages.
        No account registration is required, and inboxes are created instantly when you start using the service.
      </p>

      <h2 style="color:#e5e7eb;margin-top:32px;">Privacy & email retention</h2>
      <p>
        This service is designed with privacy in mind. TempMailFree does not require personal information,
        passwords, or user accounts. Inbox names are stored locally in your browser to improve convenience.
      </p>
      <p>
        Emails received by temporary inboxes are stored only for a limited period of time and may be automatically deleted.
        This helps reduce long-term data retention and protects user privacy.
      </p>

      <h2 style="color:#e5e7eb;margin-top:32px;">What emails are supported</h2>
      <p>
        Temporary inboxes can receive standard email messages, including verification emails and basic text-based content.
        Some emails containing large attachments, embedded media, or complex formatting may not display fully.
      </p>
      <p>
        This service is intended for sign-ups, testing, and short-term email use.
        It should not be used for sensitive, personal, or long-term communications.
      </p>

    </section>
  </div>

  <script>
    /* ===== Mask logic ===== */
    const MIN_DELAY = 2500;
    const start = Date.now();

    function showApp() {
      document.getElementById("loading").classList.add("hidden");
      document.getElementById("app").classList.remove("hidden");
    }

    function backendReady() {
      return true;
    }

    (function poll() {
      const elapsed = Date.now() - start;
      if (backendReady() && elapsed >= MIN_DELAY) {
        showApp();
      } else {
        setTimeout(poll, 500);
      }
    })();

    /* ===== App logic ===== */
    const API = "https://api.tabiland.app";
    const input = document.getElementById("name");
    const emailBox = document.getElementById("email");
    const statusBox = document.getElementById("status");
    const mailBox = document.getElementById("mail");

    function setInbox(name) {
      if (!name) return;
      emailBox.textContent = `${name}@tabiland.app`;
      statusBox.textContent = "Waiting for emails...";
      mailBox.innerHTML = "";
      localStorage.setItem("inbox", name);
    }

    input.addEventListener("input", () => {
      const name = input.value.trim();
      if (!name) {
        emailBox.textContent = "";
        statusBox.textContent = "Ready for messages...";
        mailBox.innerHTML = "";
        return;
      }
      setInbox(name);
    });

    async function pollInbox() {
      const inbox = localStorage.getItem("inbox");
      if (!inbox) return;

      try {
        const res = await fetch(`${API}/inbox/${inbox}?t=${Date.now()}`);
        const emails = await res.json();

        if (!emails.length) {
          statusBox.textContent = "Waiting for emails...";
          return;
        }

        const mail = emails[0];
        statusBox.textContent = "üì¨ Email received!";
        mailBox.innerHTML = `
          <b>From:</b> ${mail.from}<br>
          <b>Subject:</b> ${mail.subject}<br>
          <hr style="border:0;border-top:1px solid #334155;margin:10px 0;">
          <div style="white-space:pre-wrap;">${mail.text || "(no text content)"}</div>
        `;
      } catch (e) {
        statusBox.textContent = "Reconnecting to inbox‚Ä¶";
      }
    }

    const saved = localStorage.getItem("inbox");
    if (saved) {
      input.value = saved;
      setInbox(saved);
    }

    setInterval(pollInbox, 3000);
  </script>
</body>
</html>
