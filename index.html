<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Free Temporary Email â€“ TempMailFree</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://tempmailfree.site/" />
  <link rel="icon" href="/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary: #6366f1;
      --secondary: #a855f7;
      --danger: #ef4444;
      --success: #10b981;
      --text-main: #0f172a;
      --text-muted: #64748b;
      --border: #e2e8f0;
      --bg-card: #ffffff;
      --bg-input: #ffffff;
      --bg-bar: #f4f7ff;
      --bg-grad: linear-gradient(135deg, #f5f3ff 0%, #ffffff 50%, #ffffff 100%);
      --bg-item: #f8fafc;
    }

    [data-theme="dark"] {
      --text-main: #f8fafc;
      --text-muted: #94a3b8;
      --border: #334155;
      --bg-card: #1e293b;
      --bg-input: #0f172a;
      --bg-bar: #1e1b4b;
      --bg-grad: linear-gradient(135deg, #1e1b4b 0%, #0f172a 50%, #0f172a 100%);
      --bg-item: #0f172a;
    }

    * { box-sizing: border-box; transition: background 0.3s ease, color 0.3s ease, border 0.3s ease; }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, sans-serif;
      color: var(--text-main);
      line-height: 1.6;
      background: var(--bg-grad);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Side Accents (Light Mode Only) */
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image: linear-gradient(90deg, #f0f4ff 0%, transparent 10%, transparent 90%, #f0f4ff 100%);
      pointer-events: none;
      z-index: -1;
    }
    [data-theme="dark"] body::before { display: none; }

    .theme-toggle {
      position: fixed; top: 20px; right: 20px; z-index: 1000;
      background: var(--bg-card); border: 1px solid var(--border);
      color: var(--text-main); padding: 10px; border-radius: 50%;
      cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      display: flex; align-items: center; justify-content: center;
    }

    .hero { padding: 80px 20px 120px; text-align: center; }
    .hero h1 { font-size: clamp(2.5rem, 6vw, 3.8rem); font-weight: 800; margin: 0 0 16px; color: #5b21b6; }
    [data-theme="dark"] .hero h1 { color: #a78bfa; }
    .hero p { font-size: 1.2rem; color: var(--text-muted); max-width: 600px; margin: 0 auto; }

    .app-wrapper { max-width: 860px; margin: -90px auto 0; padding: 0 20px; position: relative; }
    .app-card { background: var(--bg-card); border-radius: 28px; padding: 40px; border: 1px solid var(--border); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1); }

    input { width: 100%; padding: 18px 24px; border-radius: 16px; border: 2px solid var(--border); background: var(--bg-input); color: var(--text-main); font-size: 1.1rem; outline: none; margin-bottom: 24px; }
    input:focus { border-color: var(--primary); }

    .email-bar { background: var(--bg-bar); border-radius: 20px; padding: 32px 24px; display: flex; flex-direction: column; align-items: center; gap: 20px; border: 1px solid rgba(99, 102, 241, 0.2); margin-bottom: 24px; }
    .email-text { font-weight: 800; font-size: clamp(1.2rem, 4vw, 1.8rem); color: var(--primary); text-align: center; word-break: break-all; }
    
    .actions { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
    .actions button { background: var(--bg-card); border: 1px solid var(--border); padding: 10px 22px; border-radius: 12px; color: var(--text-main); cursor: pointer; font-weight: 700; font-size: 0.9rem; }
    .actions button:hover { border-color: var(--primary); transform: translateY(-2px); }

    .messages { background: var(--bg-card); border-radius: 20px; padding: 24px; border: 1px solid var(--border); }
    .messages-header { display: flex; justify-content: space-between; align-items: center; font-weight: 800; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
    
    .refresh-controls { display: flex; align-items: center; gap: 15px; }
    .switch-label { font-size: 0.75rem; color: var(--text-muted); font-weight: 600; display: flex; align-items: center; gap: 8px; cursor: pointer; }
    .switch { position: relative; display: inline-block; width: 34px; height: 20px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #cbd5e1; transition: .4s; border-radius: 34px; }
    .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
    input:checked + .slider { background-color: var(--primary); }
    input:checked + .slider:before { transform: translateX(14px); }

    .btn-refresh { background: var(--primary); border: none; border-radius: 10px; padding: 8px 18px; cursor: pointer; color: white; font-weight: 700; }
    .btn-clear { background: transparent; border: 1px solid var(--border); color: var(--text-muted); border-radius: 8px; padding: 6px 12px; cursor: pointer; font-size: 0.8rem; margin-right: 8px; }
    .btn-clear:hover { color: var(--danger); border-color: var(--danger); }

    #mail-list { display: flex; flex-direction: column; gap: 16px; }
    .email-card { background: var(--bg-item); border: 1px solid var(--border); border-radius: 16px; padding: 24px; position: relative; animation: slideIn 0.3s ease-out; }
    .email-header-info { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; border-bottom: 1px solid var(--border); padding-bottom: 12px; padding-right: 140px; }
    .email-body { font-size: 0.95rem; white-space: pre-wrap; overflow-wrap: anywhere; word-break: break-word; color: var(--text-main); }
    
    /* Styled links and images in parsed email */
    .email-body a { color: var(--primary); text-decoration: underline; word-break: break-all; }
    .email-body img { max-width: 100%; border-radius: 8px; margin: 10px 0; display: block; border: 1px solid var(--border); }

    .card-actions { position: absolute; top: 20px; right: 20px; display: flex; gap: 8px; }
    .card-btn { border: none; padding: 6px 12px; border-radius: 8px; font-size: 0.7rem; font-weight: 700; cursor: pointer; color: white; }
    .btn-copy { background: var(--primary); }
    .btn-delete { background: var(--danger); }

    .content-wrapper { background: var(--bg-card); margin-top: 100px; padding: 80px 0; border-top: 1px solid var(--border); }
    section.content { max-width: 860px; margin: 0 auto; padding: 0 24px; color: #475569; }
    section.content h2 { color: var(--text-main); font-size: 1.8rem; font-weight: 800; margin-top: 50px; }

    /* FAQ STYLES */
    .faq-container { margin-top: 40px; display: flex; flex-direction: column; gap: 12px; }
    .faq-item { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; overflow: hidden; }
    .faq-item summary { padding: 20px 24px; list-style: none; cursor: pointer; font-weight: 700; display: flex; justify-content: space-between; align-items: center; color: var(--text-main); }
    .faq-item summary::after { content: '+'; color: var(--primary); font-size: 1.2rem; }
    .faq-item[open] summary::after { content: 'âˆ’'; }
    .faq-content { padding: 0 24px 24px; font-size: 0.95rem; color: var(--text-muted); }

    @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    footer { text-align: center; padding: 60px 20px; font-size: 0.9rem; color: var(--text-muted); }
    @media (max-width: 600px) { .app-card { padding: 24px; } .actions button { width: 100%; } .messages-header { flex-direction: column; align-items: flex-start; } }
  </style>
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
  <svg id="theme-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg>
</button>

<div class="hero">
  <h1>Free Temporary Email</h1>
  <p>TempMailFree protects your privacy and keeps your inbox spam-free</p>
</div>

<div class="app-wrapper">
  <div class="app-card">
    <input id="name" placeholder="Choose inbox name (e.g. mylogin123)" autocomplete="off" />
    <div class="email-bar">
      <div id="email" class="email-text"></div>
      <div class="actions">
        <button onclick="copyEmail()">copy</button>
        <button onclick="randomInbox()">random</button>
        <button onclick="changeInbox()">change</button>
      </div>
    </div>
    <div class="messages">
      <div class="messages-header">
        <span>Messages</span>
        <div class="refresh-controls">
          <button class="btn-clear" onclick="clearAllMails()">Clear All</button>
          <label class="switch-label">Auto-refresh <span class="switch"><input type="checkbox" id="auto-refresh-toggle" checked><span class="slider"></span></span></label>
          <button class="btn-refresh" onclick="pollInbox()">refresh</button>
        </div>
      </div>
      <div id="status" style="color:var(--text-muted); font-size:0.9rem; margin-bottom:12px;">Waiting for emailsâ€¦</div>
      <div id="mail-list"></div>
    </div>
  </div>
</div>

<div class="content-wrapper">
  <section class="content">
    <h2>How this temporary inbox works</h2>
    <p>TempMailFree provides a disposable email inbox that allows you to receive emails without using your personal email address. You choose an inbox name, and incoming emails appear automatically on this page.</p>

    <h2>Privacy & email retention</h2>
    <p>No registration, no passwords, no personal data required. Emails are stored temporarily and may be deleted automatically.</p>

    <h2>What emails are supported</h2>
    <p>Temporary inboxes support verification and standard text-based emails. Intended for short-term usage such as sign-ups and testing.</p>

    <h2>Frequently Asked Questions</h2>
    <div class="faq-container">
      <details class="faq-item"><summary>Is this disposable email service free?</summary><div class="faq-content">Yes, TempMailFree is 100% free to use. You can generate as many temporary addresses as you need without any hidden costs.</div></details>
      <details class="faq-item"><summary>How long do the emails stay in my inbox?</summary><div class="faq-content">Emails are stored temporarily on our servers. To ensure privacy and security, messages are automatically purged after a set period of inactivity.</div></details>
      <details class="faq-item"><summary>Can I send emails from this temporary address?</summary><div class="faq-content">Currently, our service is designed for receiving emails only. This protects our system from being used for spam while allowing you to receive verification codes and sign-up links.</div></details>
    </div>
  </section>
</div>

<footer>Â© 2025 TempMailFree.site â€” Free disposable email service</footer>

<script>
  const API = "https://api.tabiland.app";
  const input = document.getElementById("name");
  const emailBox = document.getElementById("email");
  const statusBox = document.getElementById("status");
  const mailList = document.getElementById("mail-list");
  const themeIcon = document.getElementById("theme-icon");
  const autoRefreshToggle = document.getElementById("auto-refresh-toggle");

  /* --- Theme Logic --- */
  function updateThemeIcon(isDark) {
    themeIcon.innerHTML = isDark 
      ? '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>'
      : '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
  }
  function toggleTheme() {
    const target = document.documentElement.getAttribute("data-theme") === "dark" ? "light" : "dark";
    document.documentElement.setAttribute("data-theme", target);
    localStorage.setItem("theme", target);
    updateThemeIcon(target === "dark");
  }
  const savedTheme = localStorage.getItem("theme") || "light";
  document.documentElement.setAttribute("data-theme", savedTheme);
  updateThemeIcon(savedTheme === "dark");

  /* --- Helpers --- */
  function hashString(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = ((hash << 5) - hash) + char;
      hash |= 0;
    }
    return hash;
  }

  function escapeHtml(text) {
    if (!text) return "";
    return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
  }

  function parseEmailContent(text) {
    if (!text) return "";
    let safe = escapeHtml(text);
    safe = safe.replace(/\[(https?:\/\/[^\]]+\.(?:png|jpg|jpeg|gif|svg)(\?[^\]]*)?)\]/gi, (match, url) => {
      return `<br><img src="${url}" alt="Image" loading="lazy"><br>`;
    });
    safe = safe.replace(/\[(https?:\/\/[^\]]+)\]/gi, (match, url) => {
      return `<a href="${url}" target="_blank">${url}</a>`;
    });
    return safe;
  }

  /* --- App Logic --- */
  let deletedHashes = JSON.parse(localStorage.getItem('deletedMailHashes') || "[]");
  let lastRenderedHtml = ""; // State to prevent "beating" re-renders

  function setInbox(name) {
    emailBox.textContent = `${name}@tabiland.app`;
    statusBox.textContent = "Waiting for emailsâ€¦";
    mailList.innerHTML = ""; 
    lastRenderedHtml = ""; // Reset render cache
    deletedHashes = []; 
    localStorage.setItem('deletedMailHashes', "[]");
    localStorage.setItem("inbox", name);
  }
  function randomInbox() { const rand = Math.random().toString(36).substring(2, 10); input.value = rand; setInbox(rand); }
  function changeInbox() { input.focus(); input.select(); }

  function copyEmail() {
    if (!emailBox.textContent) return;
    navigator.clipboard.writeText(emailBox.textContent);
    const old = statusBox.textContent;
    statusBox.textContent = "Email copied to clipboard âœ”";
    setTimeout(() => { statusBox.textContent = old; }, 2000);
  }
  function copyCard(btn, text) {
    navigator.clipboard.writeText(text);
    const old = btn.textContent; btn.textContent = "Copied!";
    setTimeout(() => { btn.textContent = old; }, 2000);
  }

  function deleteCard(btn, mailHash) {
    deletedHashes.push(mailHash);
    localStorage.setItem('deletedMailHashes', JSON.stringify(deletedHashes));
    btn.closest('.email-card').remove();
    // Invalidate cache so polling respects the deletion
    lastRenderedHtml = ""; 
    if (!mailList.children.length) statusBox.textContent = "Waiting for emailsâ€¦";
  }

  function clearAllMails() {
    if(!confirm("Delete all emails from view?")) return;
    const cards = document.querySelectorAll('.email-card');
    cards.forEach(card => {
      const hash = parseInt(card.dataset.hash);
      if(hash) deletedHashes.push(hash);
    });
    localStorage.setItem('deletedMailHashes', JSON.stringify(deletedHashes));
    mailList.innerHTML = "";
    lastRenderedHtml = "";
    statusBox.textContent = "Waiting for emailsâ€¦";
  }

  input.addEventListener("input", () => {
    const name = input.value.trim().toLowerCase().replace(/[^a-z0-9]/g, '');
    input.value = name;
    if (name) setInbox(name);
  });

  async function pollInbox() {
    const inbox = localStorage.getItem("inbox");
    if (!inbox) return;

    try {
      const res = await fetch(`${API}/inbox/${inbox}?t=${Date.now()}`);
      const emails = await res.json();
      
      if (!emails || !emails.length) return;

      const filtered = emails.filter(mail => {
        const hash = hashString(mail.from + mail.subject + (mail.text || ""));
        return !deletedHashes.includes(hash);
      });

      if (!filtered.length) {
        if (!mailList.children.length) statusBox.textContent = "Waiting for emailsâ€¦";
        return;
      }

      // Generate New HTML String
      const newHtml = filtered.map(mail => {
        const rawText = mail.text || "";
        const mailHash = hashString(mail.from + mail.subject + rawText);
        const parsedBody = parseEmailContent(rawText);
        
        return `
          <div class="email-card" data-hash="${mailHash}">
            <div class="card-actions">
              <button class="card-btn btn-copy" onclick="copyCard(this, \`${escapeHtml(rawText)}\`)">Copy Body</button>
              <button class="card-btn btn-delete" onclick="deleteCard(this, ${mailHash})">Delete</button>
            </div>
            <div class="email-header-info">
              <strong>From:</strong> ${escapeHtml(mail.from)}<br>
              <strong>Subject:</strong> ${escapeHtml(mail.subject)}
            </div>
            <div class="email-body">${parsedBody}</div>
          </div>`;
      }).join('');

      // BEATING FIX: Only update DOM if content has changed
      if (newHtml !== lastRenderedHtml) {
        statusBox.textContent = `ðŸ“¬ ${filtered.length} Email(s) received`;
        mailList.innerHTML = newHtml;
        lastRenderedHtml = newHtml;
      }

    } catch (e) { statusBox.textContent = "Reconnectingâ€¦"; }
  }

  const saved = localStorage.getItem("inbox");
  if (saved) { input.value = saved; setInbox(saved); } else { randomInbox(); }

  setInterval(() => { if (autoRefreshToggle.checked) pollInbox(); }, 3000);
</script>

</body>
</html>